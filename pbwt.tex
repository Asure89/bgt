\documentclass{article}[10pt]

\begin{document}

Let $(A_k)_{0\le k<n}=(A_0,\ldots,A_{n-1})$ be a list of $m$-long binary
strings. $(A_k)_k$ can be regarded as an $n\times m$ binary matrix with
$A_k[i]$ represencting the cell at row $k$ and column $i$.  For simplicity,
introduce a sentinel row $A_{-1}=\$_0\$_1\cdots\$_{m-1}$ with a lexicographical
order $\$_0<\cdots<\$_{m-1}$.

Define binary string:
\[
P_{ki}=A_k[i]A_{k-1}[i]\ldots A_0[i]A_{-1}[i]
\]
to be the reverse of the column prefix ending at $(k,i)$ and define $S_k(i)$ to
be the column index of the $i$-th smallest prefix among set $\{P_{kj}\}_j$.
$S_k(i)$ is a bijection on $\{0,\ldots,m-1\}$ and thus invertible. In a
special case, $S_{-1}(i)=i$ because $P_{-1,i}=A_{-1}[i]=\$_i$.

The PBWT of $(A_k)_{0\le k<n}$ is $(B_k)_{0\le k<n}$, which is
calculated by
\begin{equation}\label{eq:B}
B_k[i]=A_k[S_{k-1}(i)]
\end{equation}
An important use of $(B_k)_k$ is to compute $S_k$. Define
\begin{equation}\label{eq:phi}
\phi_k(i)=C_k(B_k[i])+{\rm rank}_k(B_k[i],i)
\end{equation}
where $C_k(b)$ gives the number of symbols in $B_k$ that are lexicographically
smaller than $b$ and ${\rm rank}_k(b,i)$ the number of $b$ symbols in $B_k$
before position $i$. The $i$-th smallest column in row $k-1$ is ranked
$\phi_k(i)$ in row $k$. Thus
\begin{equation}\label{eq:trans}
S_k(\phi_k(i))=S_{k-1}(i)
\end{equation}
This property gives us an $O(nm)$ algorithm to compute $(S_k)_k$ and $(B_k)_k$
for an input matrix $(A_k)_k$.

\end{document}
